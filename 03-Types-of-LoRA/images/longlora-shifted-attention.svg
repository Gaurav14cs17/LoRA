<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 860 380" font-family="Segoe UI,system-ui,sans-serif">
  <defs>
    <filter id="sh" x="-3%" y="-3%" width="108%" height="108%"><feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.1"/></filter>
    <marker id="arr1" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto"><polygon points="0 0,8 3,0 6" fill="#64748b"/></marker>
  </defs>
  <rect width="860" height="380" rx="16" fill="#fafbff" stroke="#e2e8f0" stroke-width="1.5"/>
  <text x="430" y="32" text-anchor="middle" font-size="18" font-weight="700" fill="#1e293b">LongLoRA: Shifted Sparse Attention (S&#178;-Attn)</text>

  <rect x="30" y="70" width="260" height="280" rx="12" fill="white" stroke="#dc2626" stroke-width="1.5" filter="url(#sh)"/>
  <text x="160" y="95" text-anchor="middle" font-size="12" font-weight="700" fill="#991b1b">Full Attention</text>
  <text x="160" y="112" text-anchor="middle" font-size="9" fill="#dc2626">O(n&#178;) too expensive for long context</text>

  <rect x="55" y="125" width="170" height="170" rx="4" fill="#fee2e2" stroke="#dc2626" stroke-width="1.5"/>
  <rect x="55" y="125" width="170" height="170" rx="0" fill="#dc2626" opacity="0.3"/>
  <text x="140" y="215" text-anchor="middle" font-size="14" font-weight="700" fill="#991b1b">n &#215; n</text>
  <text x="140" y="235" text-anchor="middle" font-size="10" fill="#dc2626">All tokens attend</text>
  <text x="140" y="250" text-anchor="middle" font-size="10" fill="#dc2626">to all tokens</text>
  <text x="160" y="335" text-anchor="middle" font-size="10" fill="#dc2626" font-weight="600">Cost: O(n&#178;) memory</text>

  <line x1="300" y1="210" x2="320" y2="210" stroke="#16a34a" stroke-width="2.5" marker-end="url(#arr1)"/>
  <text x="310" y="195" text-anchor="middle" font-size="9" fill="#16a34a" font-weight="600">S&#178;-Attn</text>

  <rect x="360" y="70" width="475" height="280" rx="12" fill="white" stroke="#16a34a" stroke-width="1.5" filter="url(#sh)"/>
  <text x="597" y="95" text-anchor="middle" font-size="12" font-weight="700" fill="#15803d">Shifted Sparse Attention (Training Only)</text>

  <text x="420" y="125" text-anchor="middle" font-size="10" font-weight="600" fill="#475569">Half heads: local groups</text>
  <rect x="380" y="135" width="85" height="85" rx="3" fill="#bbf7d0" stroke="#16a34a" stroke-width="1.5"/>
  <text x="422" y="182" text-anchor="middle" font-size="9" font-weight="600" fill="#15803d">G&#8321;</text>
  <rect x="470" y="135" width="85" height="85" rx="3" fill="#86efac" stroke="#16a34a" stroke-width="1.5"/>
  <text x="512" y="182" text-anchor="middle" font-size="9" font-weight="600" fill="#15803d">G&#8322;</text>
  <rect x="560" y="135" width="85" height="85" rx="3" fill="#4ade80" stroke="#16a34a" stroke-width="1.5"/>
  <text x="602" y="182" text-anchor="middle" font-size="9" font-weight="600" fill="#15803d">G&#8323;</text>
  <rect x="650" y="135" width="85" height="85" rx="3" fill="#22c55e" stroke="#16a34a" stroke-width="1.5"/>
  <text x="692" y="182" text-anchor="middle" font-size="9" font-weight="600" fill="white">G&#8324;</text>

  <text x="430" y="245" text-anchor="middle" font-size="10" font-weight="600" fill="#475569">Other half: shifted groups</text>
  <rect x="380" y="255" width="45" height="75" rx="3" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="402" y="297" text-anchor="middle" font-size="8" font-weight="600" fill="#1d4ed8">S&#8321;G</text>
  <rect x="430" y="255" width="85" height="75" rx="3" fill="#93c5fd" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="472" y="297" text-anchor="middle" font-size="9" font-weight="600" fill="#1d4ed8">S&#8321;</text>
  <rect x="520" y="255" width="85" height="75" rx="3" fill="#60a5fa" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="562" y="297" text-anchor="middle" font-size="9" font-weight="600" fill="white">S&#8322;</text>
  <rect x="610" y="255" width="85" height="75" rx="3" fill="#3b82f6" stroke="#2563eb" stroke-width="1.5"/>
  <text x="652" y="297" text-anchor="middle" font-size="9" font-weight="600" fill="white">S&#8323;</text>
  <rect x="700" y="255" width="45" height="75" rx="3" fill="#1d4ed8" stroke="#1e40af" stroke-width="1.5"/>
  <text x="722" y="297" text-anchor="middle" font-size="8" font-weight="600" fill="white">S&#8324;C</text>

  <rect x="740" y="135" width="85" height="190" rx="8" fill="#f0fdf4" stroke="#16a34a" stroke-width="1.5"/>
  <text x="782" y="160" text-anchor="middle" font-size="9" font-weight="700" fill="#15803d">Benefits</text>
  <text x="782" y="182" text-anchor="middle" font-size="8" fill="#475569">Shift creates</text>
  <text x="782" y="195" text-anchor="middle" font-size="8" fill="#475569">info flow</text>
  <text x="782" y="208" text-anchor="middle" font-size="8" fill="#475569">between</text>
  <text x="782" y="221" text-anchor="middle" font-size="8" fill="#475569">groups</text>
  <line x1="750" y1="232" x2="815" y2="232" stroke="#e2e8f0" stroke-width="1"/>
  <text x="782" y="250" text-anchor="middle" font-size="8" fill="#16a34a" font-weight="600">5-8&#215; faster</text>
  <text x="782" y="265" text-anchor="middle" font-size="8" fill="#16a34a">than full</text>
  <text x="782" y="280" text-anchor="middle" font-size="8" fill="#16a34a">attention</text>
  <line x1="750" y1="290" x2="815" y2="290" stroke="#e2e8f0" stroke-width="1"/>
  <text x="782" y="308" text-anchor="middle" font-size="8" fill="#6366f1" font-weight="600">Full attn at</text>
  <text x="782" y="321" text-anchor="middle" font-size="8" fill="#6366f1">inference!</text>

  <text x="597" y="360" text-anchor="middle" font-size="10" fill="#15803d" font-weight="600">Cost: O(n&#178;/G) per group - much cheaper</text>
</svg>