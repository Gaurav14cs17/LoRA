<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 920 560" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="112%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.1"/>
    </filter>
    <marker id="arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#64748B"/>
    </marker>
    <marker id="arrBlue" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#3B82F6"/>
    </marker>
    <marker id="arrOrange" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#F59E0B"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="920" height="560" rx="12" fill="#FAFBFC"/>

  <!-- Title -->
  <text x="460" y="36" text-anchor="middle" font-size="18" font-weight="700" fill="#1E293B">LoRALinear Forward Pass</text>
  <text x="460" y="56" text-anchor="middle" font-size="13" fill="#64748B">h = xW₀ᵀ + b + (α/r) · x @ A @ B</text>
  <line x1="160" y1="68" x2="760" y2="68" stroke="#E2E8F0" stroke-width="1"/>

  <!-- Input box -->
  <rect x="60" y="200" width="120" height="60" rx="8" fill="#F1F5F9" stroke="#94A3B8" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="120" y="225" text-anchor="middle" font-size="14" font-weight="700" fill="#1E293B">Input x</text>
  <text x="120" y="245" text-anchor="middle" font-size="11" fill="#64748B">(B, S, k)</text>

  <!-- Fork point -->
  <circle cx="230" cy="230" r="4" fill="#64748B"/>
  <line x1="180" y1="230" x2="230" y2="230" stroke="#64748B" stroke-width="2"/>

  <!-- === FROZEN PATH (top) === -->
  <line x1="230" y1="230" x2="230" y2="140" stroke="#3B82F6" stroke-width="2"/>
  <line x1="230" y1="140" x2="370" y2="140" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrBlue)"/>

  <!-- Frozen W0 -->
  <rect x="375" y="110" width="160" height="60" rx="8" fill="#EFF6FF" stroke="#3B82F6" stroke-width="2" filter="url(#shadow)"/>
  <text x="455" y="134" text-anchor="middle" font-size="13" font-weight="700" fill="#1E40AF">Frozen W₀</text>
  <text x="455" y="152" text-anchor="middle" font-size="11" fill="#3B82F6">(d × k) + bias</text>
  <rect x="510" y="115" width="20" height="12" rx="3" fill="#DBEAFE"/>
  <text x="520" y="124" text-anchor="middle" font-size="8" fill="#1E40AF">❄️</text>

  <line x1="535" y1="140" x2="640" y2="140" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrBlue)"/>

  <!-- h_base -->
  <rect x="645" y="115" width="120" height="50" rx="8" fill="#EFF6FF" stroke="#3B82F6" stroke-width="1.5"/>
  <text x="705" y="138" text-anchor="middle" font-size="12" font-weight="600" fill="#1E40AF">h_base</text>
  <text x="705" y="154" text-anchor="middle" font-size="10" fill="#3B82F6">(B, S, d)</text>

  <!-- === LoRA PATH (bottom) === -->
  <line x1="230" y1="230" x2="230" y2="340" stroke="#F59E0B" stroke-width="2"/>
  <line x1="230" y1="340" x2="280" y2="340" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrOrange)"/>

  <!-- Dropout -->
  <rect x="285" y="315" width="90" height="50" rx="8" fill="#FFF7ED" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="330" y="337" text-anchor="middle" font-size="12" font-weight="600" fill="#92400E">Dropout</text>
  <text x="330" y="353" text-anchor="middle" font-size="10" fill="#B45309">p = 0.05</text>

  <line x1="375" y1="340" x2="410" y2="340" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrOrange)"/>

  <!-- Matrix A -->
  <rect x="415" y="310" width="110" height="60" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2" filter="url(#shadow)"/>
  <text x="470" y="334" text-anchor="middle" font-size="13" font-weight="700" fill="#92400E">A</text>
  <text x="470" y="352" text-anchor="middle" font-size="10" fill="#B45309">(k × r)</text>
  <text x="470" y="365" text-anchor="middle" font-size="9" fill="#D97706">Kaiming init</text>

  <line x1="525" y1="340" x2="555" y2="340" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrOrange)"/>

  <!-- z bottleneck -->
  <rect x="560" y="322" width="60" height="36" rx="18" fill="#FDE68A" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="590" y="344" text-anchor="middle" font-size="11" font-weight="600" fill="#92400E">z (r)</text>

  <line x1="620" y1="340" x2="650" y2="340" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrOrange)"/>

  <!-- Matrix B -->
  <rect x="655" y="310" width="110" height="60" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2" filter="url(#shadow)"/>
  <text x="710" y="334" text-anchor="middle" font-size="13" font-weight="700" fill="#92400E">B</text>
  <text x="710" y="352" text-anchor="middle" font-size="10" fill="#B45309">(r × d)</text>
  <text x="710" y="365" text-anchor="middle" font-size="9" fill="#D97706">Zero init</text>

  <line x1="710" y1="310" x2="710" y2="280" stroke="#F59E0B" stroke-width="2"/>

  <!-- Scaling -->
  <rect x="670" y="250" width="80" height="30" rx="15" fill="#FEF3C7" stroke="#D97706" stroke-width="1.5"/>
  <text x="710" y="270" text-anchor="middle" font-size="12" font-weight="600" fill="#92400E">× α/r</text>

  <line x1="710" y1="250" x2="710" y2="200" stroke="#F59E0B" stroke-width="2"/>

  <!-- h_lora -->
  <rect x="650" y="170" width="120" height="30" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="710" y="190" text-anchor="middle" font-size="12" font-weight="600" fill="#92400E">h_lora</text>

  <!-- Sum circle -->
  <circle cx="800" cy="185" r="22" fill="#F0FDF4" stroke="#10B981" stroke-width="2.5"/>
  <text x="800" y="192" text-anchor="middle" font-size="22" font-weight="700" fill="#10B981">+</text>

  <!-- Lines to sum -->
  <line x1="765" y1="140" x2="780" y2="165" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrBlue)"/>
  <line x1="770" y1="185" x2="778" y2="185" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrOrange)"/>

  <!-- Output -->
  <line x1="822" y1="185" x2="850" y2="185" stroke="#10B981" stroke-width="2.5"/>
  <rect x="850" y="162" width="60" height="46" rx="8" fill="#F0FDF4" stroke="#10B981" stroke-width="2" filter="url(#shadow)"/>
  <text x="880" y="183" text-anchor="middle" font-size="15" font-weight="700" fill="#065F46">h</text>
  <text x="880" y="199" text-anchor="middle" font-size="10" fill="#10B981">(B,S,d)</text>

  <!-- Initialization note -->
  <rect x="60" y="420" width="400" height="55" rx="8" fill="#FFFBEB" stroke="#FDE68A" stroke-width="1"/>
  <text x="80" y="440" font-size="12" font-weight="600" fill="#92400E">Why B = 0?</text>
  <text x="80" y="458" font-size="11" fill="#78350F">B = 0 ⟹ ΔW = A·B = 0 at initialization</text>
  <text x="80" y="472" font-size="11" fill="#78350F">→ Model starts exactly at the pre-trained solution</text>

  <!-- Parameter comparison -->
  <rect x="500" y="420" width="380" height="55" rx="8" fill="#F0F9FF" stroke="#BFDBFE" stroke-width="1"/>
  <text x="520" y="440" font-size="12" font-weight="600" fill="#1E40AF">Parameter Savings (k=4096, r=16, d=4096)</text>
  <text x="520" y="458" font-size="11" fill="#1E3A5F">Full W₀: 16,777,216 params</text>
  <text x="520" y="472" font-size="11" fill="#1E3A5F">LoRA (A+B): 131,072 params (0.78% of original)</text>

  <!-- Legend -->
  <rect x="60" y="495" width="340" height="40" rx="6" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
  <rect x="80" y="510" width="14" height="14" rx="3" fill="#EFF6FF" stroke="#3B82F6" stroke-width="1.5"/>
  <text x="100" y="522" font-size="11" fill="#64748B">Frozen path</text>
  <rect x="190" y="510" width="14" height="14" rx="3" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="210" y="522" font-size="11" fill="#64748B">LoRA path (trainable)</text>
  <circle cx="330" cy="517" r="7" fill="#F0FDF4" stroke="#10B981" stroke-width="1.5"/>
  <text x="342" y="522" font-size="11" fill="#64748B">Sum</text>

  <!-- Path labels -->
  <text x="285" y="118" font-size="11" font-weight="600" fill="#3B82F6">FROZEN PATH</text>
  <text x="285" y="296" font-size="11" font-weight="600" fill="#F59E0B">LoRA PATH</text>
</svg>
